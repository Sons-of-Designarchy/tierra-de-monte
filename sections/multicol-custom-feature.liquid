{{ 'section-multicolumn-custom-box.css' | asset_url | stylesheet_tag }}
{{ 'component-slider.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  /* ===== Feature layout (title/desc/CTA left, columns right) ===== */
  #shopify-section-{{ section.id }} .mc-feature__grid { display: grid; gap: 32px; }
  @media (min-width: 990px){
    #shopify-section-{{ section.id }} .mc-feature__grid { grid-template-columns: 5fr 7fr; align-items: start; gap: 48px; }
  }
  #shopify-section-{{ section.id }} .mc-feature__lead { display:flex; flex-direction:column; gap: 16px; }
  #shopify-section-{{ section.id }} .mc-eyebrow { font-family: var(--font-body-family); font-size: 12px; letter-spacing: .12em; text-transform: uppercase; opacity:.8; }
  #shopify-section-{{ section.id }} .mc-eyebrow__rule { width: 100%; max-width: 520px; height: 2px; background: {{ section.settings.rule_color }}; margin-top: 8px; }
  #shopify-section-{{ section.id }} .mc-heading { margin: 0; }
  #shopify-section-{{ section.id }} .mc-desc { color: rgb(var(--color-foreground), .8); }
  #shopify-section-{{ section.id }} .mc-cta-wrap { margin-top: 8px; }

  /* ===== Heading size utilities (wired to setting "heading_size") ===== */
  #shopify-section-{{ section.id }} .mc-heading.h2 { font-size: clamp(28px, 3.2vw, 36px); line-height: 1.1; }
  #shopify-section-{{ section.id }} .mc-heading.h1 { font-size: clamp(36px, 4vw, 48px); line-height: 1.05; }
  #shopify-section-{{ section.id }} .mc-heading.h0 { font-size: clamp(44px, 5vw, 64px); line-height: 1.02; }
  #shopify-section-{{ section.id }} .mc-heading.hxl { font-size: clamp(56px, 6vw, 80px); line-height: 1; }
  #shopify-section-{{ section.id }} .mc-heading.hxxl { font-size: clamp(64px, 7vw, 96px); line-height: 1; }

  /* ===== Columns area ===== */
  #shopify-section-{{ section.id }} .multicolumn { border-radius: 8px; }
  #shopify-section-{{ section.id }} .multicolumn__title { display:none; }
  #shopify-section-{{ section.id }} .multicolumn-list { align-items: start; }

  /* Vertical dividers between items (desktop only) */
  @media(min-width: 990px){
    #shopify-section-{{ section.id }} .multicolumn-list__item { position: relative; padding-left: 8px; height: 60vh; }
    #shopify-section-{{ section.id }} .multicolumn-list__item + .multicolumn-list__item { border-left: 1px solid {{ section.settings.divider_color }}; }
  }

  /* Card layout: stack and push image block to bottom */
  #shopify-section-{{ section.id }} .multicolumn-card{
    display:flex; flex-direction:column; gap:12px; min-height:100%;
  }
  #shopify-section-{{ section.id }} .multicolumn-card__info { order: 1; }
  #shopify-section-{{ section.id }} .multicolumn-card__image-wrapper {
    order: 3; margin-top:auto; width:100%; border-radius:8px; overflow:hidden;
  }

  /* Media fixes + rounded image (16:9) */
  #shopify-section-{{ section.id }} .multicolumn-card__image-wrapper .media {
    position: relative;
    padding-bottom: 0 !important; /* cancel Dawn ratio if needed */
    aspect-ratio: 16 / 9;
    display: block;
    border-radius: 8px;
    overflow: hidden;
  }
  #shopify-section-{{ section.id }} .multicolumn-card__image {
    position: static !important;
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
  }

  /* Big stat/heading â€” only non-stat h3s get the clamp size */
  #shopify-section-{{ section.id }} .multicolumn-card h3:not(.mc-stat) {
    font-size: clamp(61px, 6vw, 96px);
    line-height: 1;
    margin: 0 0 4px;
  }

  /* Description font options */
  #shopify-section-{{ section.id }} .mc-desc--mono{
    font-family: 'IBMPlexMono-Light', monospace;
    font-weight:300; letter-spacing:.02em;
  }
  #shopify-section-{{ section.id }} .mc-desc--body{
    font-family: var(--font-body-family);
    font-weight: 400;
  }

  /* ===== Per-block stat (heading) controls ===== */
  #shopify-section-{{ section.id }} .mc-stat{
    line-height: 1;
    margin: 0 0 4px;
    font-size: var(--stat-size-m, 48px); /* defaults; overridden per-block via inline CSS vars */
  }
  @media (min-width: 750px){
    #shopify-section-{{ section.id }} .mc-stat{
      font-size: var(--stat-size-d, 72px);
    }
  }

  /* Font style choices */
  #shopify-section-{{ section.id }} .mc-stat--heading{
    font-family: var(--font-heading-family);
    font-weight: var(--font-heading-weight);
    letter-spacing: var(--heading-letter-spacing, 0);
  }
  #shopify-section-{{ section.id }} .mc-stat--body{
    font-family: var(--font-body-family);
    font-weight: 600;
  }
  #shopify-section-{{ section.id }} .mc-stat--mono{
    font-family: 'IBMPlexMono-Light', monospace;
    font-weight: 300;
    letter-spacing: .02em;
  }

  /* Normalize any nested tags inside the stat */
  #shopify-section-{{ section.id }} .mc-stat :is(h1,h2,h3,h4,h5,h6,p,div,span){
    all: unset;
    font: inherit;
    line-height: inherit;
    display: inline;
  }
{%- endstyle -%}

{%- liquid
  assign columns_mobile_int = section.settings.columns_mobile | plus: 0
  assign show_mobile_slider = false
  if section.settings.swipe_on_mobile and section.blocks.size > columns_mobile_int
    assign show_mobile_slider = true
  endif
-%}

<div class="multicolumn color-{{ section.settings.color_scheme }} gradient">
  <div
    class="page-width section-{{ section.id }}-padding isolate{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
    {% if settings.animations_reveal_on_scroll %} data-cascade {% endif %}
  >
    <div class="mc-feature__grid">
      <!-- Left: Eyebrow + Title + Description + CTA -->
      <div class="mc-feature__lead">
        {% if section.settings.pretitle != blank %}
          <div class="mc-eyebrow">
            {{ section.settings.pretitle }}
            {% if section.settings.show_rule %}
              <div class="mc-eyebrow__rule" aria-hidden="true"></div>
            {% endif %}
          </div>
        {% endif %}

        {% if section.settings.title != blank %}
          <h2 class="mc-heading {{ section.settings.heading_size }}">
            {{ section.settings.title }}
          </h2>
        {% endif %}

        {% if section.settings.description != blank %}
          <div class="mc-desc rte">{{ section.settings.description }}</div>
        {% endif %}

        {% if section.settings.button_label != blank %}
          <div class="mc-cta-wrap">
            <a
              class="button button--primary"
              {% if section.settings.button_link == blank %}
                role="link" aria-disabled="true"
              {% else %}
                href="{{ section.settings.button_link }}"
              {% endif %}
            >
              {{ section.settings.button_label | escape }}
            </a>
          </div>
        {% endif %}
      </div>

      <!-- Right: Columns / Stats -->
      <div>
        <slider-component class="slider-mobile-gutter">
          <ul
            class="multicolumn-list contains-content-container grid grid--{{ section.settings.columns_mobile }}-col-tablet-down grid--{{ section.settings.columns_desktop }}-col-desktop{% if show_mobile_slider %} slider slider--tablet grid--peek{% endif %}"
            id="Slider-{{ section.id }}"
            role="list"
          >
            {%- for block in section.blocks -%}
              {%- assign empty_column = '' -%}
              {%- if block.settings.image == blank
                and block.settings.title == blank
                and block.settings.text == blank
                and block.settings.link_label == blank
              -%}
                {%- assign empty_column = ' multicolumn-list__item--empty' -%}
              {%- endif -%}

              <li
                id="Slide-{{ section.id }}-{{ forloop.index }}"
                class="multicolumn-list__item grid__item{% if section.settings.swipe_on_mobile %} slider__slide{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}{{ empty_column }}"
                {{ block.shopify_attributes }}
                {% if settings.animations_reveal_on_scroll %}
                  data-cascade style="--animation-order: {{ forloop.index }};"
                {% endif %}
              >
                <div class="multicolumn-card content-container">
                  <!-- INFO FIRST (order:1) -->
                  <div class="multicolumn-card__info">
                    {%- if block.settings.title != blank -%}
                      <h3
                        class="inline-richtext mc-stat mc-stat--{{ block.settings.stat_font | default: 'heading' }}"
                        style="--stat-size-m: {{ block.settings.stat_size_mobile | default: 48 }}px; --stat-size-d: {{ block.settings.stat_size_desktop | default: 72 }}px;"
                      >
                        {{ block.settings.title }}
                      </h3>
                    {%- endif -%}

                    {%- if block.settings.text != blank -%}
                      <div class="rte {{ block.settings.desc_font | default: 'body' | prepend: 'mc-desc--' }}">
                        {{ block.settings.text }}
                      </div>
                    {%- endif -%}

                    {%- if block.settings.link_label != blank -%}
                      <a
                        class="link animate-arrow"
                        {% if block.settings.link == blank %}
                          role="link" aria-disabled="true"
                        {% else %}
                          href="{{ block.settings.link }}"
                        {% endif %}
                      >
                        {{- block.settings.link_label | escape -}}
                        <span class="svg-wrapper"><span class="icon-wrap">&nbsp;{{ 'icon-arrow.svg' | inline_asset_content }}</span></span>
                      </a>
                    {%- endif -%}
                  </div>

                  <!-- IMAGE LAST (order:3; pushed by margin-top:auto) -->
                  {%- if block.settings.image != blank -%}
                    <div class="multicolumn-card__image-wrapper multicolumn-card-spacing">
                      <div class="media media--transparent media--adapt">
                        {{
                          block.settings.image
                          | image_url: width: 3200
                          | image_tag:
                            class: 'multicolumn-card__image',
                            loading: 'lazy',
                            sizes: '(min-width: 1400px) calc((1400px - 116px) * 1 / 2), (min-width: 990px) calc((100vw - 116px) * 1 / 2), (min-width: 750px) calc((100vw - 100px) * 1 / 1), calc((100vw - 30px) * 1 / 1)'
                        }}
                      </div>
                    </div>
                  {%- endif -%}
                </div>
              </li>
            {%- endfor -%}
          </ul>

          {%- if show_mobile_slider -%}
            <div class="slider-buttons large-up-hide">
