<section id="ticker-{{ section.id }}" class="color-{{ section.settings.color_scheme }}">
  <style>
    /* Container */
    #ticker-{{ section.id }}{
      --gap: 2.5rem;
      --speed: 32s;
      position: relative;
      overflow: hidden;
    }

    /* Background (set via CSS only) */
    #ticker-{{ section.id }} .ticker-bg{
      position: absolute; inset: 0;
      background-position: center;
      background-size: cover;
      background-repeat: no-repeat;
      /* Only add background-image when an image is selected */
      {% if section.settings.bg_image != blank %}
        background-image: url({{ section.settings.bg_image | image_url: width: 2880 }});
      {% endif %}
    }

    /* Overlay (can be transparent) */
    #ticker-{{ section.id }} .ticker-overlay{
      position: absolute; inset: 0;
      background: {{ section.settings.bg_color | default: 'transparent' }};
      pointer-events: none;
    }

    /* Ticker band */
    #ticker-{{ section.id }} .ticker{
      position: relative;
      padding: .75rem 0;
      border-top: 1px solid rgba(0,0,0,.35);
    }

    /* Typography options */
    #ticker-{{ section.id }} .typo-primary{
      font-family: var(--font-heading-family);
      font-weight: var(--font-heading-weight);
      font-size: clamp(18px, 2.2vw, 28px);
      line-height: 1.2;
      letter-spacing: .08em;
      text-transform: uppercase;
    }
    #ticker-{{ section.id }} .typo-secondary{
      font-family: var(--font-body-family);
      font-weight: 400;
      font-size: clamp(14px, 1.6vw, 18px);
      line-height: 1.2;
      letter-spacing: .08em;
      text-transform: uppercase;
    }

    /* Keep both tracks on one line, seamless loop */
    #ticker-{{ section.id }} .ticker > .typo-primary,
    #ticker-{{ section.id }} .ticker > .typo-secondary{
      display: flex;
      align-items: center;
      white-space: nowrap;
      gap: 0;
    }
    #ticker-{{ section.id }} .track{
      display: inline-flex;
      align-items: center;
      gap: var(--gap);
      width: max-content;
      white-space: nowrap;
      animation: ticker-{{ section.id }} var(--speed) linear infinite;
    }
    #ticker-{{ section.id }} .track:nth-child(2){
      animation-delay: calc(var(--speed) / -2);
    }

    #ticker-{{ section.id }} .item{ display:inline-flex; align-items:center; gap:.75rem }
    #ticker-{{ section.id }} .icon{ width:22px; height:22px; object-fit:contain; flex:0 0 22px }

    @keyframes ticker-{{ section.id }}{
      from { transform: translateX(0) }
      to   { transform: translateX(calc(-100% - var(--gap))) }
    }
  </style>

  <!-- Single background + overlay -->
  <div class="ticker-bg"></div>
  <div class="ticker-overlay"></div>

  <!-- Ticker -->
  <div class="ticker">
    {% assign copy = section.settings.text | strip | default: 'VIDA QUE GENERA VIDA' %}
    <div class="{% if section.settings.typography_variant == 'primary' %}typo-primary{% else %}typo-secondary{% endif %}">
      <div class="track">
        {% for i in (1..12) %}
          <span class="item">
            {% if section.settings.icon != blank %}
              <img
                alt=""
                class="icon"
                src="{{ section.settings.icon | image_url }}"
                width="22"
                height="22"
                loading="lazy"
              >
            {% endif %}
            <span>{{ copy }}</span>
          </span>
        {% endfor %}
      </div>
      <div class="track" aria-hidden="true">
        {% for i in (1..12) %}
          <span class="item">
            {% if section.settings.icon != blank %}
              <img
                alt=""
                class="icon"
                src="{{ section.settings.icon | image_url }}"
                width="22"
                height="22"
                loading="lazy"
              >
            {% endif %}
            <span>{{ copy }}</span>
          </span>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Infinite Ticker",
  "settings": [
    { "type": "text", "id": "text", "label": "Text", "default": "VIDA QUE GENERA VIDA" },
    { "type": "image_picker", "id": "icon", "label": "Icon" },
    { "type": "image_picker", "id": "bg_image", "label": "Background image" },
    { "type": "color", "id": "bg_color", "label": "Overlay color", "default": "#00000000" },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "background-1" },
    {
      "type": "select",
      "id": "typography_variant",
      "label": "Typography",
      "options": [
        { "value": "primary", "label": "Heading font (uppercase)" },
        { "value": "secondary", "label": "Body font (uppercase)" }
      ],
      "default": "primary"
    }
  ],
  "presets": [{ "name": "Infinite Ticker" }]
}
{% endschema %}
