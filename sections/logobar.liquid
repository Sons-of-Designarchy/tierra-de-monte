{{ 'component-slider.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding{padding-top:{{ section.settings.padding_top | times: 0.75 | round: 0 }}px;padding-bottom:{{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px}
  @media(min-width:750px){.section-{{ section.id }}-padding{padding-top:{{ section.settings.padding_top }}px;padding-bottom:{{ section.settings.padding_bottom }}px}}
  #shopify-section-{{ section.id }} .logo-bar__title{text-align:center}
  #shopify-section-{{ section.id }} .logo-bar__list{display:grid;gap:{{ section.settings.gap }}px;align-items:center}
  #shopify-section-{{ section.id }} .logo-bar__item{text-align:center}
  #shopify-section-{{ section.id }} .logo-bar__img{display:inline-block;max-width:100%;opacity:.9;transition:transform .2s ease,opacity .2s ease;max-height:{{ section.settings.max_height }}px}
  #shopify-section-{{ section.id }} .logo-bar__item:hover .logo-bar__img{opacity:1;transform:scale(1.02)}
  {% if section.settings.grayscale %}#shopify-section-{{ section.id }} .logo-bar__img{filter:grayscale(100%)}#shopify-section-{{ section.id }} .logo-bar__item:hover .logo-bar__img{filter:none}{% endif %}
  @media(max-width:749px){#shopify-section-{{ section.id }} .logo-bar__list{grid-template-columns:repeat({{ section.settings.columns_mobile }},1fr)}}
  @media(min-width:750px){#shopify-section-{{ section.id }} .logo-bar__list{grid-template-columns:repeat({{ section.settings.columns_desktop }},1fr)}}
{%- endstyle -%}

{%- liquid
  assign columns_mobile_int = section.settings.columns_mobile | plus: 0
  assign show_mobile_slider = false
  if section.settings.swipe_on_mobile and section.blocks.size > columns_mobile_int
    assign show_mobile_slider = true
  endif
-%}

<section class="logo-bar color-{{ section.settings.color_scheme }} gradient">
  <div class="page-width section-{{ section.id }}-padding isolate{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}" {% if settings.animations_reveal_on_scroll %}data-cascade{% endif %}>
    <div class="logo-bar__card content-container" style="border-radius:{{ section.settings.radius }}px;">
      {%- if section.settings.title != blank -%}
        <h2 class="logo-bar__title {{ section.settings.heading_size }}">{{ section.settings.title }}</h2>
      {%- endif -%}

      <slider-component class="slider-mobile-gutter">
        <ul id="Slider-{{ section.id }}" role="list" class="logo-bar__list{% if show_mobile_slider %} slider slider--tablet grid--peek{% endif %}">
          {%- for block in section.blocks -%}
            {%- if block.settings.image != blank -%}
              <li id="Slide-{{ section.id }}-{{ forloop.index }}" class="logo-bar__item{% if section.settings.swipe_on_mobile %} slider__slide{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}" {{ block.shopify_attributes }} {% if settings.animations_reveal_on_scroll %}data-cascade style="--animation-order: {{ forloop.index }};"{% endif %}>
                {%- assign img = block.settings.image -%}
                {%- assign mh = block.settings.max_height | default: section.settings.max_height -%}
                {%- capture sizes -%}
                  (min-width: {{ settings.page_width }}px) calc(({{ settings.page_width }}px - 100px) / {{ section.settings.columns_desktop }}),
                  (min-width: 990px) calc((100vw - 100px) / {{ section.settings.columns_desktop }}),
                  (min-width: 750px) calc((100vw - 80px) / {{ section.settings.columns_mobile }}),
                  45vw
                {%- endcapture -%}
                <a{% if block.settings.link != blank %} href="{{ block.settings.link }}"{% endif %} class="logo-bar__link" aria-label="{{ block.settings.alt | escape | default: img.alt | escape }}">
                  {{ img | image_url: width: 600 | image_tag: widths: '120, 160, 200, 240, 320, 480, 600', sizes: sizes, class: 'logo-bar__img', alt: block.settings.alt | default: img.alt }}
                </a>
              </li>
            {%- endif -%}
          {%- endfor -%}
        </ul>

        {%- if show_mobile_slider -%}
          <div class="slider-buttons large-up-hide">
            <button type="button" class="slider-button slider-button--prev" name="previous" aria-label="{{ 'general.slider.previous_slide' | t }}"><span class="svg-wrapper">{{ 'icon-caret.svg' | inline_asset_content }}</span></button>
            <div class="slider-counter caption"><span class="slider-counter--current">1</span><span aria-hidden="true"> / </span><span class="visually-hidden">{{ 'general.slider.of' | t }}</span><span class="slider-counter--total">{{ section.blocks.size }}</span></div>
            <button type="button" class="slider-button slider-button--next" name="next" aria-label="{{ 'general.slider.next_slide' | t }}"><span class="svg-wrapper">{{ 'icon-caret.svg' | inline_asset_content }}</span></button>
          </div>
        {%- endif -%}
      </slider-component>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Logo bar",
  "tag": "section",
  "class": "section",
  "settings": [
    {"type":"inline_richtext","id":"title","label":"Title","default":"ALIANZAS QUE NUTREN LA TIERRA"},
    {"type":"select","id":"heading_size","label":"Heading size","default":"h2","options":[{"value":"h2","label":"H2"},{"value":"h1","label":"H1"},{"value":"h0","label":"H0"}]},
    {"type":"color_scheme","id":"color_scheme","label":"Color scheme","default":"scheme-2"},
    {"type":"range","id":"radius","label":"Corner radius (px)","min":0,"max":32,"step":2,"default":16},
    {"type":"range","id":"gap","label":"Logo gap (px)","min":8,"max":48,"step":2,"default":24},
    {"type":"checkbox","id":"grayscale","label":"Grayscale logos","default":true},
    {"type":"range","id":"max_height","label":"Max logo height (px)","min":24,"max":120,"step":2,"default":56},
    {"type":"select","id":"columns_mobile","label":"Columns on mobile","default":"2","options":[{"value":"1","label":"1"},{"value":"2","label":"2"}]},
    {"type":"range","id":"columns_desktop","label":"Columns on desktop","min":3,"max":6,"step":1,"default":5},
    {"type":"checkbox","id":"swipe_on_mobile","label":"Swipe on mobile","default":false},
    {"type":"range","id":"padding_top","min":0,"max":100,"step":4,"unit":"px","label":"Padding top","default":36},
    {"type":"range","id":"padding_bottom","min":0,"max":100,"step":4,"unit":"px","label":"Padding bottom","default":36}
  ],
  "blocks": [
    {"type":"logo","name":"Logo","settings":[
      {"type":"image_picker","id":"image","label":"Logo image"},
      {"type":"text","id":"alt","label":"Alt text"},
      {"type":"url","id":"link","label":"Link"},
      {"type":"range","id":"max_height","label":"Max height override (px)","min":24,"max":120,"step":2,"default":56}
    ]}
  ],
  "max_blocks": 8,
  "presets": [{"name":"Logo bar","blocks":[{"type":"logo"},{"type":"logo"},{"type":"logo"},{"type":"logo"},{"type":"logo"}]}]
}
{% endschema %}
